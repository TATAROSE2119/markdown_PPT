---
marp: true
size: 16:9
paginate: true



style: |
  section {
    font-family: 'Microsoft YaHei', sans-serif;
    font-size:18px;
    line-height: 1.5;
    }
  section::before {
    content: "";
    position: absolute;
    top: 0;
    right: 0;
    left: 60;
    width: 120%;
    height: 120%;
    background: url('https://github.com/TATAROSE2119/markdown_PPT/blob/main/DiMSC/img/image.png?raw=true') no-repeat right;
    background-size: contain;
    opacity: 0.1; /* 设置背景图片透明度 */
    pointer-events: none;
    }



---

# <!--fit--> 多样性诱导的多视图子空间聚类（DiMSC）
作者：Xiaochun Cao
时间：2015
会议名称：2015 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)


---

#### **1. 研究背景与动机**  
- **多视图数据的特点**  
  - 数据从多个视角/特征提取（如颜色、纹理、光流等）。  
  - 不同视图可能包含互补信息，但独立使用时存在信息冗余或不足。
  - 互补性：不同视图可能包含不同的信息。例如，颜色特征可能对光照变化敏感，而纹理特征可能对光照变化不敏感。如果能够结合这些视图的互补信息，可以提升聚类性能。
- **朴素方法的局限性**  
  - 论文中先提出了一种朴素方法（如NaMSC）独立学习视图表示，NaMSC方法的目标是将多个视图的数据表示整合到一个共同的子空间中，以便进行聚类。每个视图都使用独立的子空间表示来表示数据，但是它们并未通过任何机制来确保不同视图之间的互补性。
  $$
     \min_{Z^{(v)}} \| X^{(v)} - X^{(v)} Z^{(v)} \|_F^2 + \alpha^{(v)} \Omega(Z^{(v)})
  $$
  其中，$\Omega(Z^{(v)})$ 是一个平滑正则项，强制子空间表示满足分组效果。
  $$
  \Omega(Z^{(v)}) = \frac{1}{2} \sum_{i=1}^{n} \sum_{j=1}^{n} w_{ij}^{(v)} \| z_i^{(v)} - z_j^{(v)} \|^2_2 = \text{tr}(Z^{(v)} L^{(v)} Z^{(v)^T})
  $$

  - 缺乏对视图间依赖性的显式约束。  


---


#### **2. 方法概述**  
- **核心思想**  
  - **多样性正则化**：通过HSIC衡量视图间依赖性，强制多样性。  
  - **多视图联合优化**：交替最小化策略更新各视图表示。  

- **目标函数**  
  $$
  \mathcal{O} = \underbrace{\sum_{v} \text{重构误差}}_{\text{保证表示质量}} + \lambda_S \underbrace{\sum_{v} \text{平滑项}}_{\text{局部一致性}} + \lambda_V \underbrace{\sum_{v \neq w} \text{HSIC}}_{\text{多样性约束}}
  $$  

  $$
  O(Z^{(1)}, \dots, Z^{(V)}) = \sum_{v=1}^{V} \left( \| X^{(v)} - X^{(v)} Z^{(v)} \|_F^2 \right) + \sum_{v=1}^{V} \alpha^{(v)} \text{tr}(Z^{(v)} L^{(v)} Z^{(v)^T}) + \sum_{v \neq w} \lambda_V \text{HSIC}(Z^{(v)}, Z^{(w)})
  $$

  其中，各项的具体含义如下：

  1. **重构误差项**：
   $$
   \| X^{(v)} - X^{(v)} Z^{(v)} \|_F^2
   $$
   度量了每个视图的重构误差，确保学习到的子空间表示 $Z^{(v)}$ 能够尽可能地重构原始数据 $X^{(v)}$。
---
- 
  2. **平滑正则项**：
   $$
   \alpha^{(v)} \text{tr}(Z^{(v)} L^{(v)} Z^{(v)^T})
   $$
   它通过图拉普拉斯矩阵 $L^{(v)}$ 强制相似的样本在子空间表示中保持接近。此项的作用是保持数据点之间的结构一致性，确保同一类的数据点在聚类过程中被归到同一子空间。

  3. **多样性约束项（HSIC项）**：
   $$
   \sum_{v \neq w} \lambda_V \text{HSIC}(Z^{(v)}, Z^{(w)})
   $$
   该项是论文中提出的关键部分，利用 **Hilbert-Schmidt独立性准则（HSIC）** 来强制不同视图之间的多样性。

---  
    
   - **HSIC的定义**
    假设有两个随机变量 $X$ 和 $Y$，它们分别取值于两个不同的空间 $\mathcal{X}$ 和 $\mathcal{Y}$，并且我们有样本数据 $\{(x_i, y_i)\}$ 来估计它们的联合分布。通过映射这两个变量到适当的**再生希尔伯特空间**（RKHS），HSIC可以定义为这两个变量的**交叉协方差算子**的Hilbert-Schmidt范数。具体地，HSIC的定义如下:
    
  $$
    \text{HSIC}(p_{XY}, \mathcal{H}_X, \mathcal{H}_Y) = \|C_{XY}\|^2_{\text{HS}}
    $$
    
  其中，$C_{XY}$ 是通过核函数构建的交叉协方差算子，$\| \cdot \|_{\text{HS}}$ 是Hilbert-Schmidt范数。

---
  
  - **如何计算HSIC**

    由于直接计算HSIC通常涉及到概率密度函数的估计，实际上我们通常使用**经验版本**的HSIC来估算样本数据中的依赖性。对于给定的样本数据集 $\{(x_i, y_i)\}_{i=1}^n$，其经验估计形式为：

    $$
    \text{HSIC}(Z, \mathcal{H}_X, \mathcal{H}_Y) = \frac{1}{(n-1)^2} \text{tr}(K_X H K_Y H)
    $$

    其中：

    - $K_X$ 和 $K_Y$ 是通过核函数分别计算的 $X$ 和 $Y$ 的Gram矩阵（即相似度矩阵），分别对应于数据集中的 $X$ 和 $Y$。
    - $H = I - \frac{1}{n} \mathbf{1}$ 是居中矩阵，$\mathbf{1}$是一个所有元素都为1的列向量。

    通过这个经验版本的HSIC，我们可以计算样本数据中两个视图（或者变量）之间的依赖性。

---
  - **HSIC在DiMSC中**

    **实际上就是将不同的视图使用内积核函数隐式的投影到再生希尔伯特空间，然后根据两个视图在这个空间中的内积判断相似性。**

    $$
    \sum_{w=1, w \neq v}^V \text{HSIC}(Z^{(v)}, Z^{(w)}) = \text{tr}(Z^{(v)} K Z^{(v)^T})
    $$
    其中
    $$
    K=\sum_{w=1;w \neq v }^V HK^{(w)}H
    $$
    这个项的作用是**惩罚**视图之间的依赖性，即如果两个视图的表示 $Z^{(v)}$ 和 $Z^{(w)}$之间存在强烈的依赖性（例如冗余信息较多），HSIC将返回一个较大的值，优化过程中通过减小HSIC的值来减少视图间的冗余，提升其互补性，从而提高聚类效果。

- **优化流程**  
  1. 初始化各视图表示（如SMR）。  
  2. **交替优化**：固定其他视图，通过Sylvester方程求解当前视图的$\mathbf{Z}^{(v)}$。  
  3. 迭代至收敛（通常<5次迭代）。  

---


#### **3. 实验与结果**  
- **数据集**  
  - Yale（人脸，光照/表情变化）  
  - Extended YaleB（大范围光照变化）  
  - ORL（姿态/表情变化）  
  - Notting-Hill（视频人脸聚类）  

- **对比方法**  
  - Single\_best, FeatConcate, Co-Reg SPC, Co-Train SPC, NaMSC等。  

- **评价指标**  
  - NMI, ACC, AR, F-score, Precision, Recall。  
- **关键结果**  
  - **DiMSC全面领先**：在NMI、ACC等指标上显著优于基线（例：Extended YaleB的NMI提升4.1%）。  
  - **多样性有效性**：HSIC项显著减少冗余（对比NaMSC的相似性矩阵可视化）。  
  - **高效收敛**：5次迭代内收敛。  

![bg w:650 right:50% ](https://github.com/TATAROSE2119/markdown_PPT/blob/main2/DiMSC/img/image%20copy.png?raw=true)

---

# <!--fit--> A Novel Multimanifold Joint Projections Model for Multimode Process Monitoring

作者：Xue Xu
时间：2021
刊名：IEEE Transactions on Industrial Informatics

---

#### **1. 研究背景与问题**
- **多模态工业过程**：工业过程常涉及多个操作模式（如原料波动、生产策略调整等），传统单模态监控方法（如PCA）假设数据服从单一分布，难以处理多模态数据。
- **现有方法的不足**：
  - **单一流形假设**：现有流形学习方法假设所有数据位于同一流形，但不同模态的数据可能分布在不同的流形上。
  - **忽略模态间关联**：现有方法仅建模单个模态，未捕捉不同模态之间的关联信息，导致监控性能下降。

---

#### **2. 方法框架：多流形联合投影（MMJP）**
**核心思想**：  
通过构建**模态内邻接矩阵**（Intramode）和**模态间邻接矩阵**（Intermode），联合优化投影矩阵，保留多模态数据的局部结构（邻近距离、角度）和模态间关联。
1. **模态内特征提取**：
   - **距离邻接矩阵** $W_{D,c}$：使用热核函数计算模态内邻近点的欧氏距离，非邻近点用测地距离（Geodesic Distance）表示。
   $$
    W_{D,c}(i,j)=\begin{cases}
    e^{-\frac{\|x_{c,i}-x_{c,j}\|^{2}}{t_{1}}}, & \text{if } x_{c,i}\in N_{c,\text{intra}}(x_{c,j}) \text{ or } x_{c,j}\in N_{c,\text{intra}}(x_{c,i}) \\
    e^{-\frac{\|x_{c,i}-x_{c,j}\|^{2}_{G}}{t_{2}}}, & \text{if } x_{c,i}\notin N_{c,\text{intra}}(x_{c,j}) \text{ and } x_{c,j}\notin N_{c,\text{intra}}(x_{c,i})
    \end{cases}
   $$  
   - **角度邻接矩阵**$W_{A,c}$：通过余弦相似度捕捉邻近点的角度关系。
   $$
   W_{A,c}(i,j)=\begin{cases}
    \frac{(x_{c,i}-x_{c,k})^{T}(x_{c,j}-x_{c,k})}{\|x_{c,i}-x_{c,k}\|\|x_{c,j}-x_{c,k}\|}, & \text{if } x_{c,i} \text{ 和 } x_{c,j} \in N_{c,\text{intra}}(x_{c,k}) \\
    0, & \text{otherwise}
    \end{cases}
    $$  

   - **融合**：$W_{\text{intra},c} = W_{D,c} + W_{A,c}$，综合距离和角度信息。

---


#### **3. 原始MMJP的融合方式与局限**
在原始MMJP中，模内邻接矩阵通过**直接相加**距离邻接矩阵 $W_{D,c}$（反映物理差异）和角度邻接矩阵 $W_{A,c}$（反映动态关联）得到：
$$
W_{\text{intra},c} = W_{D,c} + W_{A,c}.
$$
**物理局限**：
- **冗余信息干扰**：若距离和角度信息高度相关（如温度与压力强相关），直接相加会重复加权同一特征，导致局部结构过拟合。
- **互补性丢失**：若两者独立性高（如温度与流量弱相关），直接相加可能削弱互补信息的表达。
- **问题举例**：  
  当两个特征（如温度 $T$ 和压力 $P$）高度相关时，$W_{D,c}$ 和 $W_{A,c}$ 捕捉的是同一物理现象的两种不同表示。  
  - **距离矩阵 $W_{D,c}$**：反映样本间绝对数值差异（如 $T$ 和 $P$ 的欧氏距离）。  
  - **角度矩阵 $W_{A,c}$**：反映变量变化的协同性（如 $T$ 和 $P$ 的余弦相似度）。  
  **若两者强相关，它们本质上描述的是同一模式的变化。**

- **直接相加的后果**：  
  对同一特征重复加权，导致模型过度关注这一模式，而忽略其他独立特征。

---

#### **假设实验：化工反应器的温度与压力监控**
某反应器在正常操作下，温度 $T$ 和压力 $P$ 强相关（$T$ 升高时 $P$ 同步升高）。

- **训练数据中的样本**：  
  - 样本 A：$T=100°C, P=1.0MPa$
  - 样本 B：$T=110°C, P=1.1MPa$  
  - 样本 C：$T=90°C, P=0.9MPa$

- **距离邻接矩阵 $W_{D,c}$**：  
  - 样本 A 与 B 的欧氏距离小（$T$和$P$均相近），权重 $W_{D,c}(A,B)$ 较大。  
  - 样本 A 与 C 的欧氏距离大（$T$和$P$均差异大），权重 $W_{D,c}(A,B)$ 较小。

- **角度邻接矩阵 $W_{A,c}$**：  
  - 样本 A 与 B 的余弦相似度高（变化方向一致），权重 $W_{A,c}(A,B)$ 较大。  
  - 样本 A 与 C 的余弦相似度低（变化方向相反），权重 $W_{A,c}(A,C)$ 较小。

- **融合后的邻接矩阵 $W_{\text{intra},c}$**：  
  $$
  W_{\text{intra},c}(A,B) = W_{D,c}(A,B) + W_{A,c}(A,B) = 0.9 + 0.8 = 1.7
  $$
  $$
  W_{\text{intra},c}(A,C) = W_{D,c}(A,C) + W_{A,c}(A,C) = 0.1 + 0.2 = 0.3
  $$
  **结果**：样本 A 与 B 的相似性，即温度和压力的协同变化模式被显著放大，而样本 A 与 C 的差异性，即非协同变化模式被进一步抑制。

---

#### **假设实验的结果: 局部结构过拟合**
- **模型训练**：  
  模型会过度依赖 \( T \) 和 \( P \) 的协同变化模式，认为这是唯一重要的特征。

- **实际故障场景**：  
  若发生传感器故障，导致 \( T \) 异常升高但 \( P \) 未同步变化，这时候：
  - **距离矩阵**：新样本与正常样本的欧氏距离较大（因 \( T \) 异常）。  
  - **角度矩阵**：新样本与正常样本的余弦相似度低（因 \( T \) 与 \( P \) 变化方向不一致）。  
  - **融合后的邻接矩阵**：理论上应能检测到异常。  
  **但由于训练时过度强化了 \( T-P \) 协同变化模式，模型可能误认为单独变化的 \( T \) 属于噪声，导致漏报。**

---

#### **2. HSIC的引入与物理意义**
HSIC（Hilbert-Schmidt Independence Criterion）通过核方法衡量两个变量的独立性。引入HSIC后，优化目标变为：
$$
\min \left\| W_{\text{intra},c} - (\alpha W_{D,c} + \beta W_{A,c}) \right\|_F^2 + \lambda \cdot \text{HSIC}(W_{D,c}, W_{A,c}),
$$
   - **独立性约束**：强制两种信息的互补性最大化。  
     - 若两者独立（HSIC值低）：赋予较高权重，保留独特特征（如温度差异与流量方向无关）。  
     - 若两者相关（HSIC值高）：降低冗余权重，避免重复建模（如温度与压力强相关时，仅保留其一主导特征）。  


---

#### **3. 改进后的物理优势**
1. **更精确的局部结构建模**：
   - **独立特征增强**：例如，在原料切换时，温度差异可能独立于流量方向变化，HSIC可分离这两种特征，避免误判。
   - **冗余特征抑制**：在稳定模式下，若温度与压力高度相关，HSIC减少重复加权，防止模型过拟合。

2. **复杂动态的表征能力提升**：
   - **非线性路径优化**：测地距离结合HSIC，更准确刻画参数变化的实际路径（如设备预热阶段的温度-时间曲线）。
   - **跨模态关联强化**：HSIC优化后的模内矩阵与模间矩阵（\(W_{\text{inter},cp}\)）协同，捕捉模式切换时的传导效应（如预热→反应阶段的压力渐变）。

3. **故障检测灵敏度提升**：
   - **互补信息保留**：独立的角度和距离特征可检测不同类型故障（如传感器漂移由距离特征捕捉，控制逻辑异常由角度特征捕捉）。
   - **误报率降低**：冗余信息抑制减少对正常波动的误判（如温度周期性波动不被误认为故障）。

---

#### **4. 实例说明**
**案例**：某化工反应器的多模态监控  
- **模式1**（低温反应）：温度差异（\(W_{D,c}\)）主导，流量与温度弱相关（HSIC赋予角度低权重）。  
- **模式2**（高温反应）：温度与压力强相关（HSIC降低角度权重），测地距离捕捉非线性升温路径。  
- **故障场景**：某次模式切换时，温度异常骤升但压力未响应。  
  - **原始MMJP**：可能因角度权重过高，误判为正常协同变化。  
  - **改进MMJP-HSIC**：HSIC检测到温度与压力独立性突增，触发故障报警。

---

#### **5. 挑战与权衡**
1. **计算复杂度增加**：HSIC的核矩阵计算（\(O(n_c^3)\)）可能影响实时性，需优化离线建模流程。
2. **参数敏感性**：\(\lambda\) 和核函数选择需结合实际数据分布调试（如高斯核 vs. 线性核）。
3. **物理假设冲突**：若工业过程天然存在强耦合变量（如电机转速与电流），独立性约束可能导致信息丢失。

---

2. **模态间特征提取**：
   - **模态间邻接矩阵**$W_{\text{inter},cp}$：使用KNN算法选择跨模态邻近点，构建模态间关联。
    $$
    W_{\text{inter}, cp}(i, j) = 
    \begin{cases} 
    e^{-\frac{\|x_{c,i} - x_{p,j}\|^2}{t_3}}, & \text{if } x_{c,i} \in N_{cp,\text{inter}}(x_{p,j}) \text{ 或 } x_{p,j} \in N_{pc,\text{inter}}(x_{c,i}) \\
    0, & \text{其他情况}
    \end{cases}
    $$

3. **全局亲和矩阵**$W_{\text{global}}$：
   - 将模态内和模态间矩阵拼接为块矩阵，全面表征多模态数据的结构：
     $$
     W_{\text{global}} = \begin{bmatrix}
     W_{\text{intra},1} & W_{\text{inter,12}} & \cdots \\
     W_{\text{inter,21}} & W_{\text{intra},2} & \cdots \\
     \vdots & \vdots & \ddots
     \end{bmatrix}
     $$
---

4. **优化目标**：
   - 最小化投影后低维空间中邻接关系的失真：
     $$
     \min P^T X L X^T P \quad \text{s.t.} \quad P^T P = I
     $$
   - 通过特征分解求解投影矩阵 \(P\)，保留数据的关键几何结构。

---

#### **3. 在线监控方案**
- **模式识别（PMD准则）**：
  - 计算新样本到各模态流形的距离，选择最小距离对应的模式。
  - 使用**测地距离**衡量样本与流形代表点（Exemplar）的相似性。

- **统计量计算**：
  - **T²统计量**：衡量投影空间中的变异。
  - **Q统计量**：衡量残差空间的变异。
  - 控制限通过F分布和χ²分布设定。

---

#### **4. 实验验证**
- **数值案例**和**TE过程**实验表明：
  - MMJP在 **故障检测率（FDR** 和 **误报率（FAR）** 上优于对比方法（如多PCA、多LPP）。
  - 对模态间关联的建模显著提升了复杂故障的检测能力。

---
